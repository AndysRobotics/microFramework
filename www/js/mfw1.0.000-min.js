const mfw={engine:"1.0.000",data:{},lastRender:0,maxLoopItterations:20,bindableAttributes:["data-if","data-for","data-innerHtml","data-switch","data-value","data-param","data-src","data-class","data-class-if"],getDataByPath:function(t=""){let e=this.data;if(!t||!e)return;let a=t.split(".");for(let t of a){if(void 0===e[t])return;e=e[t]}return e},setDataByPath:function(t="",e){if(!t||"string"!=typeof t)return;let a=t.split(".");if(!a.length)return;let r=this.data;if(1==a.length)r[a[0]]=e;else{for(let t=0;t<a.length-1;t++){let e=a[t];"object"!=typeof r[e]&&(r[e]={}),r=r[e]}r[a[a.length-1]]=e}},getDataFromInputGroup(t){if(!t||"string"!=typeof t)return{};let e={};for(let t of document.querySelectorAll("[data-group]")){let a=t.name;a&&("checkbox"==t.type?e[a]=!!t.checked:e[a]=t.value)}return e},getDataFromElement(t){if(!t||"function"!=typeof t.getAttribute)return{index:null,api:null,param:null,groupData:{}};let e=t.getAttribute("data-param"),a=t.getAttribute("data-group");return{index:t.getAttribute("data-each-index"),api:t.getAttribute("data-api"),param:this.getDataByPath(e),groupData:this.getDataFromInputGroup(a)}},showElement(t){t&&"function"==typeof t.getAttribute&&t.style&&(t.style.display=t.getAttribute("data-show")||"block")},hideElement(t){t&&"function"==typeof t.getAttribute&&t.style&&(t.style.display="none")},init:function(){this.render(),document.addEventListener("input",t=>{this._handleDocumentInteraction(t)})},render:function(){this._renderForLoops(),this._renderSwithes(),this._renderClassNames(),this._renderIfs(),this._renderInnerHtml(),this._renderImageSrcs(),this._renderInputValues(),this.lastRender=Date.now()},_handleDocumentInteraction:function(t){if(!t||!t.target||"function"!=typeof t.target.getAttribute)return;if("INPUT"!=t.target.tagName&&"TEXTAREA"!=t.target.tagName)return;if(!t.target.getAttribute("data-value"))return;let e=t.target.getAttribute("data-value");if(!e)return;let a=t.target.value;"checkbox"==t.target.type&&(a=!!t.target.checked),this.getDataByPath(e)!==a&&(this.setDataByPath(e,a),this.render())},_testCondition:function(t){if(!t||"string"!=typeof t)return!1;if(this.getDataByPath(t))return!0;if("!"==t.charAt(0)&&!this.getDataByPath(t.substring(1)))return!0;let e=t.split("!=");return 2==e.length?this.getDataByPath(e[0])!=e[1]:2==(e=t.split(">=")).length?this.getDataByPath(e[0])>=e[1]:2==(e=t.split("<=")).length?this.getDataByPath(e[0])<=e[1]:2==(e=t.split("=")).length?this.getDataByPath(e[0])==e[1]:2==(e=t.split("<")).length?this.getDataByPath(e[0])<e[1]:2==(e=t.split(">")).length&&this.getDataByPath(e[0])>e[1]},_renderForLoops:function(){let t=this;for(let t of document.querySelectorAll("[data-each-index]"))t.remove();for(let t of document.querySelectorAll("[data-for]"))t.removeAttribute("data-loop-processed");function e(t,e,a,r){if(!e||"function"!=typeof e.getAttribute||!a)return;let i=a.length,n=e.getAttribute(t);n==a?e.setAttribute(t,n+"."+r):n&&n.substring(0,i+1)==a+"."&&(n=n.replace(a+".",a+"."+r+"."),e.setAttribute(t,n))}function a(a,r,i){if(a&&"function"==typeof a.getAttribute)for(let n of t.bindableAttributes){e(n,a,r,i);for(let t of a.querySelectorAll(":scope ["+n+"]"))e(n,t,r,i)}}let r=0;for(;r<this.maxLoopItterations;){let t=!1;for(let e of document.querySelectorAll("[data-for]")){let r=e.getAttribute("data-for"),i=e.querySelectorAll(":scope > [data-each]");if(e.getAttribute("data-loop-processed"))continue;e.setAttribute("data-loop-processed",!0),t=!0;let n=this.getDataByPath(r);if(i.length&&n&&n.length){for(let t=0;t<n.length;t++){let n=i[0].cloneNode(!0);n.setAttribute("data-each-index",t),n.removeAttribute("data-each"),a(n,r,t),e.appendChild(n)}this.showElement(e)}else this.hideElement(e)}if(!t)break;r++}for(let t of document.querySelectorAll("[data-for]"))t.removeAttribute("data-loop-processed");r==this.maxLoopItterations&&console.error("Max loop itterations reached")},_renderSwithes:function(){for(let t of document.querySelectorAll("[data-switch]")){let e=t.getAttribute("data-switch"),a=this.getDataByPath(e);if("string"!=typeof a)this.hideElement(t);else{let e=!1;for(let r of t.querySelectorAll(":scope > [data-case]")){if(r.getAttribute("data-case")==a){e=!0,this.showElement(r);break}this.hideElement(r)}let r=t.querySelectorAll(":scope > [data-default]");r.length&&(e?this.hideElement(r[0]):(e=!0,this.showElement(r[0]))),e?this.showElement(t):this.hideElement(t)}}},_renderIfs:function(){for(let t of document.querySelectorAll("[data-if]")){let e=t.getAttribute("data-if");this._testCondition(e)?this.showElement(t):this.hideElement(t)}},_renderInnerHtml:function(){for(let t of document.querySelectorAll("[data-innerHtml]")){let e=t.getAttribute("data-innerHtml"),a=this.getDataByPath(e);t.innerHTML=a||0===a||!1===a?a:t.getAttribute("data-unknown")||""}},_renderImageSrcs:function(){for(let t of document.querySelectorAll("[data-src]")){let e=t.getAttribute("data-src"),a=this.getDataByPath(e);a?(this.showElement(t),t.src=a):(this.hideElement(t),t.src="")}},_renderClassNames:function(){for(let t of document.querySelectorAll("[data-class]")){let e=t.getAttribute("data-class");t.className=this.getDataByPath(e)||""}for(let t of document.querySelectorAll("[data-class-if]")){let e=t.getAttribute("data-class-if");if(!e||"string"!=typeof e)continue;let a=e.split(";");if(2!=a.length)continue;e=a[0];let r=a[1];t.classList.remove(r),this._testCondition(e)&&t.classList.add(r)}},_renderInputValues:function(){for(let t of document.querySelectorAll("[data-value]")){let e=t.getAttribute("data-value");"checkbox"==t.type?this.getDataByPath(e)?t.setAttribute("checked",""):t.removeAttribute("checked"):t.value=this.getDataByPath(e)||""}}};